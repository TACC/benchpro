==========================
Benchmark Job Template
==========================

Below is an example of a benchmark job generated by BenchPRO, including the various prepopulated variables and paths setup.

.. _bench_temp:

.. code-block::

    #!/bin/bash
    #SBATCH -J ljmelt
    #SBATCH -o /scratch1/06280/mcawood/benchpro/results/pending/mcawood_ljmelt_2023-06-20T14-01_001N_56R_01T_00G/stdout.log
    #SBATCH -e /scratch1/06280/mcawood/benchpro/results/pending/mcawood_ljmelt_2023-06-20T14-01_001N_56R_01T_00G/stderr.log
    #SBATCH -p small
    #SBATCH -t 00:10:00
    #SBATCH -N 1
    #SBATCH -n 56
    #SBATCH -A A-ccsc
    echo "START `date +"%Y"-%m-%dT%T` `date +"%s"`"

    echo "JobID:    ${SLURM_JOB_ID}"
    echo "User:     ${USER}"
    echo "Hostlist: ${SLURM_NODELIST}"

    export         working_path=/scratch1/06280/mcawood/benchpro/results/pending/mcawood_ljmelt_2023-06-20T14-01_001N_56R_01T_00G
    export          output_file=stdout.log
    export             mpi_exec=ibrun
    export          base_module=/scratch1/06280/mcawood/benchpro/apps/modulefiles
    export           app_module=frontera/cascadelake/intel22/intel22impi/lammps/23Jun2022/default
    export              threads=1
    export                ranks=56
    export                nodes=1
    export                 gpus=0

    # Create working directory
    mkdir -p ${working_path} && cd ${working_path}
    
    export             template=lammps
    export          bench_label=ljmelt
    export              dataset=ljmelt_4M_per_node_250_steps
    export        collect_stats=True
    export     script_additions=
    export                  exe=lmp_intel_cpu_intelmpi
    export                 arch=
    export           local_repo=/scratch1/06280/mcawood/benchpro/repo
    export               stdout=stdout.log
    export               stderr=stderr.log
    export      OMP_NUM_THREADS=${threads}

    # Load Modules
    ml use /scratch1/hpc_tools/benchpro-dev/modulefiles
    ml use ${base_module}
    ml benchpro
    ml ${app_module}
    ml

    # [files]
    stage https://web.corral.tacc.utexas.edu/ASC23006/datasets/in.ljmelt_4M_per_node_250_steps


    #-------USER SECTION------
    ...
    #-------------------------

    # Provenance data collection script
    $BPS_INC/resources/scripts/stats/collect_stats $BP_RESULTS/pending/mcawood_ljmelt_2023-06-20T14-01_001N_56R_01T_00G/hw_report

    echo "END `date +"%Y"-%m-%dT%T` `date +"%s"`"
